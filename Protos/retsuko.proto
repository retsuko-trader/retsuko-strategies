syntax = "proto3";

import "google/protobuf/timestamp.proto";

service GStrategyLoader {
  rpc GetStrategies (Empty) returns (StrategyList);
}

message Empty {}

message StrategyList {
  repeated GStrategy strategies = 1;
}

message GStrategy {
  string name = 1;
  string config = 2;
}

service GStrategyRunner {
  rpc Create (StrategyCreate) returns (StrategyRun);
  rpc Preload (StrategyPush) returns (Empty);
  rpc Process (StrategyPush) returns (Empty);
  rpc End (StrategyRun) returns (StrategyState);
}

message StrategyCreate {
  string name = 1;
  string config = 2;
  optional string state = 3;
}

message StrategyRun {
  string id = 1;
}

message StrategyPush {
  string id = 1;
  repeated CandleRaw candles = 2;
}

message StrategyState {
  string state = 1;
}

message CandleRaw {
  int32 market = 1;
  int32 symbolId = 2;
  int32 interval = 3;
  google.protobuf.Timestamp ts = 4;
  double open = 5;
  double high = 6;
  double low = 7;
  double close = 8;
  double volume = 9;
}
